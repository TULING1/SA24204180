<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Zukun li" />

<meta name="date" content="2024-12-08" />

<title>Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">Zukun li</h4>
<h4 class="date">2024-12-08</h4>



<div id="homework0" class="section level1">
<h1>homework0</h1>
<div id="美国七十个城市的年降水量分布" class="section level2">
<h2>1美国七十个城市的年降水量分布</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">data</span>(precip)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">hist</span>(precip,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;美国城市年降水量&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;降水量&quot;</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;频数&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>     )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="美国年客运里程营收变化" class="section level2">
<h2>2美国年客运里程营收变化</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(airmiles)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">plot</span>(airmiles)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>对数据进行一元回归分析，即假设年客运营收<span class="math inline">\(Y_{i}\)</span>和年数<span class="math inline">\(X_{i}\)</span>符合 <span class="math display">\[Y_{i}=\beta_{0}+\beta_{1}X_{i}\]</span>
由最小二乘法得到<span class="math display">\[{\hat{\theta_{1}}}=\frac{{\sum_{i}}(X_{i}-{\overline{X}})(Y_{i}-{\overline{Y}})}{{\sum_{i}}(X_{i}-{\overline{X}})^2}
\]</span> <span class="math display">\[{\hat{\theta_{0}}}={\overline{Y}}-{\hat{\theta_{1}}}{\overline{X}}
\]</span> 将回归方程作出</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">Year =</span> <span class="fu">as.numeric</span>(<span class="fu">time</span>(airmiles)),<span class="at">Miles =</span> <span class="fu">as.numeric</span>(airmiles))</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Miles<span class="sc">~</span>Year,<span class="at">data =</span>df)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">plot</span>(df<span class="sc">$</span>Year, </span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>     df<span class="sc">$</span>Miles, </span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>     <span class="at">main=</span><span class="st">&quot;Air Miles Over Time&quot;</span>,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Year&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;Miles&quot;</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>     <span class="at">col=</span><span class="st">&quot;blue&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>     )</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="fu">abline</span>(model, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="绘制指数分布图" class="section level2">
<h2>3绘制指数分布图</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">rweibull</span>(<span class="dv">10000</span>,<span class="at">shape=</span><span class="dv">1</span>,<span class="at">scale=</span><span class="fl">0.06</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">hist</span>(x,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&#39;频数&#39;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&#39;取值&#39;</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>     <span class="at">density=</span><span class="dv">10</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>     <span class="at">nclass=</span><span class="dv">100</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>#homework1</p>
</div>
<div id="question-3.4" class="section level2">
<h2>Question 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is <span class="math display">\[f(x)=
\frac{x}{\sigma^{2}}e^{-\frac{x^{2}}{2\sigma^{2}}},x\ge0,\sigma^{2}&gt;0\]</span>
Develop an algorithm to generate random samples from a Rayleigh<span class="math inline">\((\sigma)\)</span> distribution. Generate
Rayleigh<span class="math inline">\((\sigma)\)</span> samples for
several choices of <span class="math inline">\(\sigma&gt;0\)</span> and
check that the mode of the generated samples is close to the theoretical
mode</p>
<p><span class="math inline">\(\sigma\)</span> (check the
histogram).</p>
</div>
<div id="answer-3.4" class="section level2">
<h2>Answer 3.4</h2>
<p>Let<span class="math inline">\(t=x^{2}\)</span>.</p>
<p>So <span class="math inline">\(f(t)=\frac{1}{2\sigma^{2}}e^{-\frac{t}{2\sigma^{2}}},F(t)=1-e^{-\frac{t}{2\sigma^{2}}}\)</span>.</p>
<p>Actually,<span class="math inline">\(t\sim
Exp(\frac{1}{2\sigma^{2}})\)</span>.</p>
<p>Then,let <span class="math inline">\(u=F(t)=1-e^{-\frac{t}{2\sigma^{2}}}\)</span>.</p>
<p>So,<span class="math inline">\(u\sim U(0,1)\)</span>.</p>
<p>In that way,<span class="math inline">\(t=-2\sigma^{2}ln(1-u),x=\sqrt{t}\)</span>.Finally,we
get: <span class="math display">\[x=\sqrt{-2\sigma^{2}ln(1-u)}\]</span></p>
<p>Let<span class="math inline">\(\sigma\)</span> takes three different
values:1,2,3</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">122</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>n<span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>t1<span class="ot">&lt;-</span><span class="dv">1</span> <span class="co">#σ&#39;s value</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>t2<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>t3<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="dv">1</span><span class="fl">-0.0001</span>)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(t1<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(t2<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>x3<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(t3<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,.<span class="dv">01</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="fu">hist</span>(x1,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main =</span><span class="st">&#39;σ=1&#39;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t1<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">**</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>t1<span class="sc">**</span><span class="dv">2</span>)))</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">hist</span>(x2,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main =</span><span class="st">&#39;σ=2&#39;</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t2<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">**</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>t2<span class="sc">**</span><span class="dv">2</span>)))</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">hist</span>(x3,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main =</span><span class="st">&#39;σ=3&#39;</span>)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(t3<span class="sc">**</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">**</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>t3<span class="sc">**</span><span class="dv">2</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAk1BMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OpA6ZpA6ZrY6kNtmAABmADpmAGZmOjpmOmZmOpBmkNtmtttmtv+QOgCQOjqQOmaQZjqQtpCQ29uQ2/+2ZgC2Zjq2kDq229u22/+2/7a2///T09PbkDrbkGbbtmbb25Db/7bb////tmb/25D/27b//7b//9v///+f5HqYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKVElEQVR4nO2djXbbRBCFlRCHFuwUKHEL2ECbmEKdWH7/p0OyrCaxdvbuzM7YWmfu4RzaU/nu6NNod7Srn2rriqo6dQBjlwMCckBADgjIAQE5ICAHBOSAgBwQkAMCckBADgjIAQE5ICAHBOSAgBwQkAMCckBADgjIAQGpAFpe3mnYhFX/eV19t7Dz3/7T+H8i/1UB0ONvlSWgL9X77fLCjtDD9WQzu/pK/XM+oM3s4toSUKt1dWtpX8/pHeADevxQtZr0f9/8/HfEn69D/1ZLRUAB/8fZhNycDWgzu/z0OGtSfrVrp5rGDwBbAf8mgfROsYD/ZqbZB61by9Uu7l6qgAL+D9cVfYQV/LexPo4NaNVme9uKUQYN/Rs+pv7bPbWwpBn0vE+wyKAn/3queIIF448OAsI+6MWwaNAHPfNfV6pD2MD/SzWtI4WcbBT74UXZoApo4L98OhNM/Ou/rAvF85YDAnJAQA4IyAEBOSAgBwTkgIAcEJADAnJAQA4IyAEBOSAgBwTkgIAcEJADAnJAQKcFtN7NNxsuvOfrpIDq+W694uEteevA6XVSQJt3d8/+N06NIoPeOCBCD9eF90EP3y+aftT67h87KQwCUUD1h0Xbgdp1ouvq4nfVWxNeSmMQiAJqes+HH8OdaKVxbrYH4Po2vAPtoc/1jw0Cqf7xjf5cNPuwbSEN/VPcgZrI64931A7cZzcRGwR0ANXz1id0h6PC8f22A5tf+ga6W3aq7o/5gGKDgA6gyO9UUqgZBJqO6HAH9ABFpAno6RR4OsI6gCIxaWXQxLQPon+jCehwB/b+On3Q+vLuVIDMUkgN0I7M5t1nO0DhQqsYQO0Q3BD66c2wi9ABRBRaeoCiB0ClD2p3YH05PIV1ABGFlhogcACsUlQ/g94YAQIHQAtQyF+pDwoXWuoZRByA8WdQ5Dc68ccPgAMC/vkN0IOAA2qlMQicNSCNQeCsAWkMAmcNSGMQOG9ACv4OKGFjaQOCn7L8HRDwd0DAf/yA2gJiNZy0d0C9GkDrieV8EB1TMYBWU8P5oEhMhQCaXf37/vm61csGxBEmxFQGoLYUvVjsFq9CDcjCS4upFEDRBgQ/Rc5VH3hRgIiFw3HsgLV/TgaNYges/YWAqiPsgNnavCIgcsrSGlBVBiB6ytIB7URPWTqgnegpSwfUiZyyLAMQuNgueRRTAxS72HZA9MV2evznDYi82HZAe1EX20cCZEToCKPYmQCy9XdAwN8BNZ10F+bwHsVSAEUvhhUyaHPz0vpb2IUAil8Ma5xi6+BzJsUAil8Mex8ELobVABlX0t3t6sEGsncgejFcQAahUWDso1jcPy1+NN0xtc6gwONKeoDAlHE+oO12dfGHHSDicSU1QGjKWANQ08jgiUbdUWz4uJJeoQimjFUAhX+jlEHk40q6GURNGWsBCqysqvVBxONKSn0QmDIefQbF/UsYxRQaSNDJKul8QArDpEDlANIYJgUqB5DGMBmV9XRHWPoZlDNMpvjbTXcEJQC0mYU/7KEwTMb81aY7qPjDEmXQivHxE0kGBf0VpzvM4n+2zSr1IzrCUyzgrzrdYRN/v826PQKJr6OTABL4swCZxd/3QZwvnEn6IIE/qw8yi38MlTThP6pRrJt3SHzZmiCDJP6cDLKLv92mexFX+FVc2Q3I/ZMBmcb/LIOSJcwgrj83g7j+6YA27z7vZudT32fIBST0TwZkGr930njjVuvJZpb8rUUBIIk/B5Bd/N029YfFapL8Rk8+IJE/AxDlr7bs03Ryy2mgpwu/a1XUSQf9yZj4nXTIX2/Zp/74+WYxPALEu1YFGRT2p2PiZlDYX3HZZ11d/XczeKMn8a5VSR8U9KdjYvdBQX/zZZ/Bu1YFDQhUdfajWvZZhesI6l2rFRcQ4U/F1ANKboDpz++kk9O/+w0XUKp/b8sFxI1f+VJjuLJaMQlxLwXYgISXGgn++02WnA9y8wGJ/DmnWNgf3t+UDGjDvJZhZ5DEn5NBhD91lysj/vgmVCXKziCWBBlEibjLlQ+oOQS/Dm6UoitRNqCwPxkTG5DEnwOoIbG8ZVSiXECEPxkTF1DcPyv+p2uxW/paZlCJCkaxkD8Zk2AU4/uzMyhwvlKVqCiDgv1BOCZRBnH9uX1Q+gdSZH0Q25/ZB4X8FQYZ2YxiIaOYxiBz1oA0Bpluk921XnKxywck8mcAIvw1BpndJsu2e6vnqbdHsAHJ/O+TGyD9FQaZbtmH9yU9LiChfzIg0/gdENzYAYGNyVkBnQai/tE6JR2QZfwnHebjdUp6J83Us/ix/0kBxesUBwTqlBIAUU8EKgGK1ykFACKfCNQCRMVUCiDyiUAH1GnwROCggaxA6ZhKAUQ+Eag1ilHLMsUAgg0Ifv1c0WWZcgDlr6ySii3LlAMo0oDg18n+DqhXwZU0nPS23IECAOFJ71cOCE96Z+6AznQHKfJdrtoZRBeKeTtgPd1BvstVrQ+Ck975R3hr2EmT73JVA0T9RjmDrKY7yHe5lgLIfrqDeJdrMYCi/gWMYhoNyP0VACnUcWcNSKOOGyWgSquTVqjjzhrQYJTsg3ZAe+E6DjYwdkAWDTigA8X6IAcU8ndAwP+YgEx2QA0QLhRfN6CEQjEPUHzdavyAEgrFzAwKP8lXVYUASpjwyz3FwutWpQA6WaFoBuiF873VEVAHNFhZPWYGlQBo8JvSAXF2wAGhjaP/ShRaDmgvqtAyJlQOIKrQckB7UYWWA+pFFFpnBQg0kD2KOSDUgCjGFH8HBPwdEPB3QMDfAQF/BwT8760aODIgsx1wQMD/WIDiDZwWUHS2QAFQwmzEEQDJ9yA+W3Bv7F8AoPhsQT6gpNmILEAKKRpTfLZAL4OisxE5gDRSNKrobEE+oKTZiBxAGikq0CEg7QYO44/650+Y5exA0ihm5a+QQYkpKt6DxFHMyD8tfo1RTLwHiaOYkb8eoOjKqsYRPrwLdUz+Futa6QqfwqPyPy2gAiQpFLXFe132kf0lheKrkqRQfFWSFIp6U4rEKXxc/4xKmhoFqv6H3/4gE3UKH8H/4D9aoua1doA6hY/gXwYg8hS29y8DkPUpHPEvBNDp/B0Q8LcF9JrkgIAcEJADAnJAQA4IyAEBOSAgBwQkALRmfENEonH58wFtbhaDy2NNjcyfD+jh7dc6+WNwAo3Mnw+offEe66OXZfs7ICA/xYC8kwbyYR7IC0UgBwTkgIAcEJADAnJAQA4IyAEBOSAgBwTkgIAcEJADAnJAQA4IyAEBOSCgTEC2N+HX86r9EK6dlnhyMQ/QZpb6hW6RVpP+Tl4brSf4CAsBLa++1vNp/fHwG7Va6vzbP62mpv5WgLbL6XKS4i/V3t+sgb3/yuwUq+e7FymbAer9gy+01vPHa4hSQO13qbaGgDr/wZevlP23+BQWAmr6zt27uK0Adf52C4idf8oqtAxQPW+tA5+iV9Lef9k+aWHRSffxL7G9F4pADgjIAQE5ICAHBOSAgBwQkAMCckBADgjIAQE5ICAHBOSAgBwQkAMC+h+KAUsrrRNs2QAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the result,we could find the simulation is good.</p>
</div>
<div id="question-3.11" class="section level2">
<h2>Question 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture.
The</p>
<p>components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(0,3)\)</span> distributions with mixing</p>
<p>probabilities <span class="math inline">\(p_{1}\)</span> and <span class="math inline">\(p_{2}=1-p_{1}\)</span>. Graph the histogram of the
sample</p>
<p>with density superimposed, for <span class="math inline">\(p_{1}=.75\)</span>. Repeat with different values
for p1</p>
<p>and observe whether the empirical distribution of the mixture appears
to be</p>
<p>bimodal. Make a conjecture about the values of p1 that produce
bimodal</p>
<p>mixtures.</p>
</div>
<div id="answer-3.11" class="section level2">
<h2>Answer 3.11</h2>
<p>The CDF of this distribution is:<span class="math display">\[F(x)=p_{1}\Psi(x)+p_{2}\Psi(x),p_{1}+p_{2}=1\]</span></p>
<p>Let <span class="math inline">\(p_{1}\)</span> has the
value:0.75,0.5,0.25</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>p11<span class="ot">=</span><span class="fl">0.75</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>p21<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>p31<span class="ot">=</span><span class="fl">0.25</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>p12<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p11</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>p22<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p21</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>p32<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>p31</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>r1<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p12,p11))</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>r2<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p22,p21))</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>r3<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size =</span> n,<span class="at">replace =</span> <span class="cn">TRUE</span>,<span class="at">prob =</span> <span class="fu">c</span>(p32,p31))</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>z1<span class="ot">&lt;-</span>r1<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r1)<span class="sc">*</span>x2</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>z2<span class="ot">&lt;-</span>r2<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r2)<span class="sc">*</span>x2</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>z3<span class="ot">&lt;-</span>r3<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>r3)<span class="sc">*</span>x2</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">hist</span>(z1,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">main =</span><span class="st">&quot;p1=0.75&quot;</span>)</span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="fu">hist</span>(z2,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">main =</span><span class="st">&quot;p1=0.5&quot;</span>)</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="fu">hist</span>(z3,<span class="at">breaks =</span> <span class="dv">50</span>,<span class="at">main =</span><span class="st">&quot;p1=0.25&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We found that the positions of these two peaks are located on 0 and
3,</p>
<p>respectively, which are the means of the original two
distributions.What’s</p>
<p>more,the probability of a function is higher,the peak of this
function is</p>
<p>also higher.</p>
</div>
<div id="question-3.20" class="section level2">
<h2>Question 3.20</h2>
<p>A compound Poisson process is a stochastic process {<span class="math inline">\(X(t),t≥ 0\)</span>}that can be</p>
<p>represented as the random sum <span class="math inline">\(X(t)=
\sum_{i=1}^{N(t)}Yi, t\ge0,\)</span>where{<span class="math inline">\(N(t),t≥ 0\)</span>}</p>
<p>is a Poisson process and <span class="math inline">\(Y1,Y2,...\)</span>are iid and independent of<span class="math inline">\(N(t),t≥ 0\)</span>}.</p>
<p>Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)–Gamma</p>
<p>process (Y has a Gamma distribution). Estimate the mean and the
variance of</p>
<p>X(10) for several choices of the parameters and compare with the
theoretical</p>
<p>values. Hint: Show that <span class="math inline">\(E[X(t)] =
λtE[Y_{1}]\)</span> and <span class="math inline">\(Var(X(t)) =
λtE[Y_{1}^{2}]\)</span>.</p>
</div>
<div id="answer-3.20" class="section level2">
<h2>Answer 3.20</h2>
<p>We know:<span class="math display">\[P(N(t+s)-N(s)=n)=\frac{(\lambda
t)^{n}}{n!}e^{-\lambda t}\ \ \ \ n=0,1,...\]</span> <span class="math display">\[N(0)=0\]</span> And,<span class="math inline">\(y_{i}\)</span>’s distribution is:<span class="math display">\[
f(x)=\frac{\beta^{\alpha}x^{\alpha-1}}{\Gamma(x)}e^{-\beta x},x\ge0
\]</span> <span class="math display">\[X(t)=\sum_{i=1}^{N(t)}Y_{i},t\ge0\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>size<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>t<span class="ot">=</span><span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>lambda <span class="ot">=</span><span class="dv">3</span><span class="co">#the parameter of poisson process</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>shape<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>scale<span class="ot">&lt;-</span><span class="dv">1</span><span class="co">#the parameters of Gamma distribution</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">qpois</span>(<span class="dv">1</span><span class="fl">-1e-9</span>,<span class="at">lambda =</span>lambda<span class="sc">*</span>t)<span class="co">#the largest number which the poisson process can get</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>poip<span class="ot">=</span><span class="cf">function</span>(z){</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  </span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>}</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>xn<span class="ot">&lt;-</span><span class="fu">rpois</span>(size,lambda<span class="sc">*</span>t)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>xs<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size){</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>  yi<span class="ot">=</span><span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fu">rgamma</span>(n,<span class="at">shape =</span> shape,<span class="at">scale =</span> scale)))</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>  xs<span class="ot">&lt;-</span><span class="fu">c</span>(xs,yi[xn[i]])</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>}</span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Mean and Variance of the sample&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Mean and Variance of the sample&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(xs))</span></code></pre></div>
<pre><code>## [1] 29.95529</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">var</span>(xs))</span></code></pre></div>
<pre><code>## [1] 60.64472</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Theoretical mean and variance&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Theoretical mean and variance&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">print</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>shape<span class="sc">*</span>scale)</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">print</span>(lambda<span class="sc">*</span>t<span class="sc">*</span>(shape<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>shape<span class="sc">*</span>scale<span class="sc">**</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
<p>We found that the mean and variance of the sample are very close to
the</p>
<p>theoretical values</p>
<p>#homework2</p>
</div>
<div id="question-5.4" class="section level2">
<h2>Question 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3,3)
cdf,and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x=0.1,0.2,...,0.9\)</span>.Compare the estimates
with the values returned by the <span class="math inline">\(pbeta\)</span> function in R.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>As <span class="math inline">\(F(x)=\int_{-\infty}^{x}f(x)dx\)</span>
In this question,</p>
<p><span class="math display">\[\begin{align}
F(x) = &amp;\int_{0}^{x}f(x;\alpha,\beta)dx\\
=&amp; \int_{0}^{x}beta(x;3,3)dx\\
=&amp;\int_{0}^{x}\frac{1}{B(3,3)}x^{3-1}(1-x)^{3-1}dxB\\
\end{align}
\]</span> We use Monte Carlo estimator: <span class="math display">\[\begin{align}
&amp;F(x) = E_{x}(\frac{1}{x\times b(3,3)}t^{2}(1-t)^{2})dt\\
&amp;x\sim U(0,1)\\
&amp;Its estimate:\hat{\theta}=\frac{1}{m}\sum_{i=1}^{m}\frac{1}{x\times
b(3,3)}t_{i}^{2}(1-t_{i})^{2}
\end{align}
\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>Beta.cdf <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">runif</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">dbeta</span>(x<span class="sc">*</span>y,<span class="dv">3</span>,<span class="dv">3</span>))<span class="sc">*</span>x)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>}</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">sapply</span>(t,<span class="cf">function</span>(t) <span class="fu">pbeta</span>(t,<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">sapply</span>(t,<span class="cf">function</span>(t) <span class="fu">Beta.cdf</span>(t))</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(x1,x2),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1]   [,2]   [,3]   [,4]   [,5]   [,6]   [,7]   [,8]   [,9]
## x1 0.0086 0.0579 0.1631 0.3174 0.5000 0.6826 0.8369 0.9421 0.9914
## x2 0.0086 0.0578 0.1614 0.3205 0.4963 0.6838 0.8364 0.9428 0.9845</code></pre>
</div>
<div id="question-5.9" class="section level2">
<h2>Question 5.9</h2>
<p>The Rayleigh density is <span class="math display">\[\\f(x)=\frac{x}{\sigma^{2}}e^{-x^{2}/(2\sigma^{2})},x\geq0,\sigma&gt;0\]</span>
Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>)distribution, using antithetic
variables.What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{&#39;}}{2}\)</span>compared with <span class="math inline">\(\frac{X_{1}+X_{2}}{2}\)</span>for independent<span class="math inline">\(X_{1},X_{2}\)</span>?</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>Make <span class="math display">\[\begin{align}
&amp;u=1-e^{-\frac{x^{2}}{2\sigma^{2}}}\\
&amp;u^{&#39;}=1-u=e^{-\frac{x^{2}}{2\sigma^{2}}}\\
we\ get\  &amp;u\sim U(0,1)\\
&amp;x=\sigma\sqrt{-2ln(1-u)}\\
and\ &amp;x^{&#39;}=\sigma\sqrt{-2ln(u)}
\end{align}
\]</span> So we get the function below which can generate samples from a
Rayleigh(<span class="math inline">\(\sigma\)</span>)distribution,using
antithetic variables:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">2</span><span class="co">#value of σ</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>pdf1.Rayleigh <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  u1<span class="ot">=</span><span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u1))<span class="sc">**</span><span class="fl">0.5</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>}</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>pdf2.Rayleigh <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  u2<span class="ot">=</span><span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">*</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(u2))<span class="sc">**</span><span class="fl">0.5</span>)</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>}</span></code></pre></div>
<p><span class="math display">\[\begin{align}
as\
E(X)&amp;=\int_{0}^{\infty}\frac{x^{2}}{\sigma^{2}}e^{-\frac{x^{2}}{2\sigma^{2}}}dx\\
&amp;=\sqrt{\frac{\pi}{2}}\sigma\\
and\ Var(x)&amp;=E(X^{2})-(E(X))^{2}\\
&amp;=\int_{0}^{\infty}\frac{x^{3}}{\sigma^{2}}e^{-\frac{x^{2}}{2\sigma^{2}}}dx-\frac{\pi}{2}\sigma^{2}\\
&amp;=(2-\frac{\pi}{2})\sigma^{2}\\
we\ can\ get\ \
Var(\frac{X_{1}+X_{2}}{2})&amp;=(1-\frac{\pi}{4})\sigma^{2}\approx0.2146\sigma^{2}\\
and \
Var(\frac{X+X^{&#39;}}{2})&amp;=(1-\frac{\pi}{4})\sigma^{2}+\frac{Cov(X,X^{&#39;})}{2}\\
because\ X&amp;=\sigma\sqrt{-2ln(1-u)}\\
and\ X^{&#39;}&amp;=\sigma\sqrt{-2ln(u)}\ (u\sim U(0,1))\\
so\ Cov(X,X^{&#39;})&amp;=E(XX^{&#39;})-E(X)E(X^{&#39;})\\
&amp;=\int_{0}^{1}2\sigma^{2}\sqrt{ln(x)ln(1-x)}dx-\frac{\pi}{2}\sigma^{2}\\
&amp;\approx-0.4065\sigma^{2}\\
then\ Var(\frac{X+X^{&#39;}}{2})&amp;\approx0.0114\sigma^{2}\\
finally,we\ find\ the\ percent\\
reduction\ in\ varience\ is\ about:\\
&amp;94.7\%
\end{align}
\]</span></p>
</div>
<div id="question-5.13" class="section level2">
<h2>Question 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_{1}\)</span>and<span class="math inline">\(f_{2}\)</span>that are supported on<span class="math inline">\((1,\infty)\)</span>and are ‘closed’ to <span class="math display">\[g(x)=\frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}\   \
x&gt;1.
\]</span> Which of your two importance functions should produce the
smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^{2}}{\sqrt{2\pi}}e^{-x^{2}/2}dx
\]</span> by importance sampling?Explain.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>}</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">g</span>(x)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The probability distribution of the function is mainly concentrated
in (1,4) Derive the function,we get:</p>
<p><span class="math display">\[
\frac{\partial g(x)}{\partial
x}=\frac{1}{\sqrt{2\pi}}(2x-x^{3})e^{-\frac{x^{2}}{2}}=0\\
we\ find\ when\ x=\sqrt{2}\\
g(x)\ get\ the\ maximum\ value\sqrt{\frac{2}{\pi}}e^{-1}
\]</span> so,we choose the importance function <span class="math inline">\(f_{1}\sim N(1.5,1)\)</span>and <span class="math inline">\(f_{2}\sim Weibull(2,2)\)</span></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>g <span class="ot">=</span> <span class="cf">function</span> (x) {</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>}</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">g</span>(x)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>y_norm<span class="ot">&lt;-</span><span class="fu">dnorm</span>(x,<span class="at">mean =</span> <span class="fl">1.5</span>, <span class="at">sd=</span> <span class="dv">1</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>y_weibull<span class="ot">&lt;-</span><span class="fu">dweibull</span>(x,<span class="at">shape =</span> <span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="fu">lines</span>(x,y_norm,<span class="at">col=</span><span class="st">&quot;red&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">lines</span>(x,y_weibull,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>sd_norm<span class="ot">&lt;-</span><span class="fu">sd</span>(y<span class="sc">/</span>y_norm)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>sd_weibull<span class="ot">&lt;-</span><span class="fu">sd</span>(y<span class="sc">/</span>y_weibull)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="fu">rbind</span>(sd_norm,sd_weibull)</span></code></pre></div>
<pre><code>##                 [,1]
## sd_norm    0.2441490
## sd_weibull 0.2309507</code></pre>
<p>so ,the weibull distribution is better</p>
</div>
<div id="question-fast-sort" class="section level2">
<h2>Question: Fast Sort</h2>
<p>For <span class="math inline">\(n=10^{4},2*10^{4},4*10^{4},6*10^{4},8*10^{4}\)</span>,apply
the fast sorting algorithm to randomly permuted numbers of
1,…,n. Calculate computation time averaged over 100 simulations,denoted
by<span class="math inline">\(a_{n}\)</span>. Regress <span class="math inline">\(a_{n}\ on\ t_{n}:=nlog(n)\)</span>,and graphically
show the results(scatter plot and regression line).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">10000</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="fu">c</span>(n,<span class="dv">2</span><span class="sc">*</span>n,<span class="dv">4</span><span class="sc">*</span>n,<span class="dv">6</span><span class="sc">*</span>n,<span class="dv">8</span><span class="sc">*</span>n)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="do">##快速排序算法</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>quicksort<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>)<span class="fu">return</span>(x)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>    x0<span class="ot">&lt;-</span>x[<span class="dv">1</span>]</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>    loc<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>    low<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>    high<span class="ot">&lt;-</span>n</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>    <span class="cf">while</span>(low<span class="sc">!=</span>high){</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>        <span class="cf">if</span>(loc<span class="sc">==</span>low){</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>            <span class="cf">if</span>(x[high]<span class="sc">&lt;</span>x[loc]){</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>                tmp<span class="ot">&lt;-</span>x[high]</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>                x[high]<span class="ot">&lt;-</span>x[loc]</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>                x[loc]<span class="ot">&lt;-</span>tmp</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>                low<span class="ot">=</span>low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>                loc<span class="ot">=</span>high</span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>                    high<span class="ot">=</span>high<span class="dv">-1</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>                }</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>                <span class="cf">if</span>(x[low]<span class="sc">&gt;</span>x[loc]){</span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>                    tmp<span class="ot">&lt;-</span>x[low]</span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>                    x[low]<span class="ot">&lt;-</span>x[loc]</span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>                    x[loc]<span class="ot">&lt;-</span>tmp</span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>                    high<span class="ot">=</span>high<span class="dv">-1</span></span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>                    loc<span class="ot">=</span>low</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>                }<span class="cf">else</span>{</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>                    low<span class="ot">=</span>low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>                }</span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>           }</span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>        }</span>
<span id="cb26-35"><a href="#cb26-35" tabindex="-1"></a>    L<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb26-36"><a href="#cb26-36" tabindex="-1"></a>    R<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb26-37"><a href="#cb26-37" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&gt;</span><span class="dv">1</span>) L<span class="ot">=</span>x[<span class="dv">1</span><span class="sc">:</span>(low<span class="dv">-1</span>)]</span>
<span id="cb26-38"><a href="#cb26-38" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&lt;</span><span class="fu">length</span>(x)) R<span class="ot">=</span>x[(low<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb26-39"><a href="#cb26-39" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">quicksort</span>(L),x[low],<span class="fu">quicksort</span>(R)))</span>
<span id="cb26-40"><a href="#cb26-40" tabindex="-1"></a>}</span>
<span id="cb26-41"><a href="#cb26-41" tabindex="-1"></a></span>
<span id="cb26-42"><a href="#cb26-42" tabindex="-1"></a>time<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb26-43"><a href="#cb26-43" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb26-44"><a href="#cb26-44" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> t){</span>
<span id="cb26-45"><a href="#cb26-45" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb26-46"><a href="#cb26-46" tabindex="-1"></a>  random_sample<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n,i,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb26-47"><a href="#cb26-47" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">100</span>)</span>
<span id="cb26-48"><a href="#cb26-48" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb26-49"><a href="#cb26-49" tabindex="-1"></a>    start<span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb26-50"><a href="#cb26-50" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">quicksort</span>(random_sample)</span>
<span id="cb26-51"><a href="#cb26-51" tabindex="-1"></a>    end<span class="ot">&lt;-</span><span class="fu">Sys.time</span>()</span>
<span id="cb26-52"><a href="#cb26-52" tabindex="-1"></a>    x[j]<span class="ot">&lt;-</span>(end<span class="sc">-</span>start)</span>
<span id="cb26-53"><a href="#cb26-53" tabindex="-1"></a>  }</span>
<span id="cb26-54"><a href="#cb26-54" tabindex="-1"></a>  time[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb26-55"><a href="#cb26-55" tabindex="-1"></a>}</span>
<span id="cb26-56"><a href="#cb26-56" tabindex="-1"></a><span class="do">##回归分析</span></span>
<span id="cb26-57"><a href="#cb26-57" tabindex="-1"></a>x_log_x<span class="ot">&lt;-</span>t<span class="sc">*</span><span class="fu">log</span>(t)</span>
<span id="cb26-58"><a href="#cb26-58" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(time <span class="sc">~</span> x_log_x)</span>
<span id="cb26-59"><a href="#cb26-59" tabindex="-1"></a>y_pred<span class="ot">&lt;-</span><span class="fu">predict</span>(model)</span>
<span id="cb26-60"><a href="#cb26-60" tabindex="-1"></a>polt_data<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x_log_x=</span>x_log_x,<span class="at">y=</span>time,<span class="at">y_pred=</span>y_pred)</span>
<span id="cb26-61"><a href="#cb26-61" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data,<span class="fu">aes</span>(<span class="at">x=</span>x_log_x))<span class="sc">+</span></span>
<span id="cb26-62"><a href="#cb26-62" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>y),<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)<span class="sc">+</span>  </span>
<span id="cb26-63"><a href="#cb26-63" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>y_pred),<span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb26-64"><a href="#cb26-64" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Regression of y on x * log(x)&quot;</span>,</span>
<span id="cb26-65"><a href="#cb26-65" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;x * log(x)&quot;</span>,</span>
<span id="cb26-66"><a href="#cb26-66" tabindex="-1"></a>       <span class="at">y=</span><span class="st">&quot;y&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-67"><a href="#cb26-67" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p>#homework3</p>
</div>
<div id="question-6.6" class="section level2">
<h2>Question 6.6</h2>
<p>Estimate the 0.025,0.05,0.95,and 0.975 quantiles of the skewness<span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte
Carlo experiment.Compute the standard error of the estimates
from(2.14)using the normal approximation for the density(with exact
variance formula).Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_{1}}\sim N(0,6/n)\)</span>.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">30</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>n_sim<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>skew_value<span class="ot">&lt;-</span><span class="fu">numeric</span>(n_sim)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_sim){</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  sample_data<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  skew_value[i]<span class="ot">&lt;-</span><span class="fu">sum</span>((sample_data<span class="sc">-</span><span class="fu">mean</span>(sample_data))<span class="sc">^</span><span class="dv">3</span>)<span class="sc">*</span>(n<span class="sc">^</span><span class="fl">0.5</span>)<span class="sc">/</span>((<span class="fu">sd</span>(sample_data)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">^</span><span class="fl">0.5</span>)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>}</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>quantiles<span class="ot">&lt;-</span><span class="fu">quantile</span>(skew_value,<span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>))</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>standard_error<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n)</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;estimate quantiles of skewness: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## estimate quantiles of skewness:</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">print</span>(quantiles)</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## -0.8165818 -0.6633176  0.6621008  0.7927188</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;standard error:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## standard error:</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">print</span>(standard_error)</span></code></pre></div>
<pre><code>## [1] 0.4472136</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>theory_quantiles<span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>(<span class="dv">6</span><span class="sc">/</span>n)<span class="sc">^</span><span class="fl">0.5</span>)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;theoretical quantiles of large sample approximation:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## theoretical quantiles of large sample approximation:</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">print</span>(theory_quantiles)</span></code></pre></div>
<pre><code>## [1] -0.8765225 -0.7356009  0.7356009  0.8765225</code></pre>
<p>we can get that the estimated value is very close to the theoretical
value.</p>
</div>
<div id="question-6.8" class="section level2">
<h2>Question 6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the
<span class="math inline">\(F\)</span> test of equal variance, at
significance level <span class="math inline">\(\hat{a}\dot{=}0.055\)</span>.Compare the power of
the Count Five test and <span class="math inline">\(F\)</span> test for
small,medium,and large sample sizes.(Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal
distributions.)</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>count5test<span class="ot">=</span><span class="cf">function</span>(x,y){</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>  X<span class="ot">&lt;-</span>x<span class="sc">-</span><span class="fu">mean</span>(x)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>  Y<span class="ot">&lt;-</span>y<span class="sc">-</span><span class="fu">mean</span>(y)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>  outx<span class="ot">&lt;-</span><span class="fu">sum</span>(X<span class="sc">&gt;</span><span class="fu">max</span>(Y))<span class="sc">+</span><span class="fu">sum</span>(X<span class="sc">&lt;</span><span class="fu">min</span>(Y))</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>  outy<span class="ot">&lt;-</span><span class="fu">sum</span>(Y<span class="sc">&gt;</span><span class="fu">max</span>(X))<span class="sc">+</span><span class="fu">sum</span>(Y<span class="sc">&lt;</span><span class="fu">min</span>(X))</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy))<span class="sc">&gt;</span><span class="dv">5</span>))</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>}</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.055</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>num<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">20</span>,<span class="dv">100</span>)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>power_five<span class="ot">&lt;-</span>power_F<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>count_five_power<span class="ot">&lt;-</span>F_test_power<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>  count_five_reject<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>  f_test_reject<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rnorm</span>(num[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(num[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb39-21"><a href="#cb39-21" tabindex="-1"></a>    </span>
<span id="cb39-22"><a href="#cb39-22" tabindex="-1"></a>    count_five_reject<span class="ot">&lt;-</span>count_five_reject<span class="sc">+</span><span class="fu">count5test</span>(x,y)</span>
<span id="cb39-23"><a href="#cb39-23" tabindex="-1"></a>    f_test_reject<span class="ot">&lt;-</span>f_test_reject<span class="sc">+</span>(<span class="fu">var.test</span>(x,y)<span class="sc">$</span>p.value<span class="sc">&lt;</span>alpha)</span>
<span id="cb39-24"><a href="#cb39-24" tabindex="-1"></a>  }</span>
<span id="cb39-25"><a href="#cb39-25" tabindex="-1"></a>  count_five_power[i]<span class="ot">&lt;-</span>count_five_reject<span class="sc">/</span>m</span>
<span id="cb39-26"><a href="#cb39-26" tabindex="-1"></a>  F_test_power[i]<span class="ot">&lt;-</span>f_test_reject<span class="sc">/</span>m</span>
<span id="cb39-27"><a href="#cb39-27" tabindex="-1"></a>}</span>
<span id="cb39-28"><a href="#cb39-28" tabindex="-1"></a><span class="fu">rbind</span>(count_five_power,F_test_power)</span></code></pre></div>
<pre><code>##                   [,1]  [,2]  [,3]
## count_five_power 0.000 0.299 0.881
## F_test_power     0.121 0.406 0.985</code></pre>
<p>We find ,as the sample size increases, the efficiency of both types
of detection gradually increases.</p>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.</p>
<p>1.What is the corresponding hypothesis test problem?</p>
<p>2.What test should we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p>
<p>3.Please provide the least necessary information for hypothesis
testing.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>We can’t say the powers are different at 0.05 level.</p>
<p>The corresponding hypothesis test problem is :if the powers of two
methods are different,which is “<span class="math inline">\(H_{0}:
power_{1}=power_{2}\)</span> vs <span class="math inline">\(H_{1}:
power_{1} \neq power_{2}\)</span>”.</p>
<p>We should use paired-t test.Because there is only one sample for each
of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span> in this question, so multiple
experiments should be performed to generate a large of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span>, thereby obtaining many
differences of <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span>.</p>
<p>We can find that the difference between <span class="math inline">\(power_{1}\)</span> and <span class="math inline">\(power_{2}\)</span> is diff, a lot of diff
approximately obey the t distribution. The null hypothesis can be tested
by applying paired-t test.</p>
<p>#homework4</p>
</div>
<div id="problem-1" class="section level2">
<h2>Problem 1</h2>
<p>Of N = 1000 hypotheses, 950 are null and 50 are alternative.The
p-value under any null hypothesis is uniformly distributed(use runif),
and the p-value under any alternative hypothesis follows the beta
distribution with parameter 0.1 and 1 (use rbeta). Obtain Bonferroni
adjusted p-values and B-H adjusted p-values. Calculate FWER, FDR, and
TPR under nominal level α =0.1 for each of the two adjustment methods
based on m=10000 simulation replicates. You should output the 6 numbers
(3 ) to a 3×2 table (column names: Bonferroni correction, B-H
correction; row names: FWER, FDR, TPR). Comment the results.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>n_null<span class="ot">&lt;-</span><span class="dv">950</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>n_alt<span class="ot">&lt;-</span><span class="dv">50</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.1</span></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>results<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="fu">rownames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a><span class="fu">colnames</span>(results)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>  p_null<span class="ot">&lt;-</span><span class="fu">runif</span>(n_null)</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>  p_alt<span class="ot">&lt;-</span><span class="fu">rbeta</span>(n_alt,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>  p_value<span class="ot">&lt;-</span><span class="fu">c</span>(p_null,p_alt)</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>  </span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>  bonf_p<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_value,<span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>  bh_p<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(p_value,<span class="at">method=</span><span class="st">&quot;BH&quot;</span>)</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>  </span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>  reject_bonf<span class="ot">&lt;-</span>bonf_p<span class="sc">&lt;</span>alpha</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>  true_positive_bonf<span class="ot">&lt;-</span><span class="fu">sum</span>(reject_bonf[(n_null<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N])</span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>  false_positive_bonf<span class="ot">&lt;-</span><span class="fu">sum</span>(reject_bonf[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>  fwer_bonf<span class="ot">&lt;-</span><span class="fu">ifelse</span>(false_positive_bonf<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>  fdr_bonf<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">sum</span>(reject_bonf)<span class="sc">&gt;</span><span class="dv">0</span>,false_positive_bonf<span class="sc">/</span><span class="fu">sum</span>(reject_bonf),<span class="dv">0</span>)</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a>  tpr_bonf<span class="ot">&lt;-</span>true_positive_bonf<span class="sc">/</span>n_alt</span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>  </span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>  reject_bh<span class="ot">&lt;-</span>bh_p<span class="sc">&lt;</span>alpha</span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>  true_positive_bh<span class="ot">&lt;-</span><span class="fu">sum</span>(reject_bh[(n_null<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N])</span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>  false_positive_bh<span class="ot">&lt;-</span><span class="fu">sum</span>(reject_bh[<span class="dv">1</span><span class="sc">:</span>n_null])</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a>  fwer_bh<span class="ot">&lt;-</span><span class="fu">ifelse</span>(false_positive_bh<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>  fdr_bh<span class="ot">&lt;-</span><span class="fu">ifelse</span>(<span class="fu">sum</span>(reject_bh)<span class="sc">&gt;</span><span class="dv">0</span>,false_positive_bh<span class="sc">/</span><span class="fu">sum</span>(reject_bh),<span class="dv">0</span>)</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a>  tpr_bh<span class="ot">&lt;-</span>true_positive_bh<span class="sc">/</span>n_alt</span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a>  </span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a>  results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>fwer_bonf</span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a>  results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>fdr_bonf</span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a>  results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni correction&quot;</span>]<span class="sc">+</span>tpr_bonf</span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a>  </span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a>  results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>fwer_bh</span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a>  results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>fdr_bh</span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a>  results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="ot">&lt;-</span>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>]<span class="sc">+</span>tpr_bh</span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a>}</span>
<span id="cb41-41"><a href="#cb41-41" tabindex="-1"></a>result<span class="ot">&lt;-</span>results<span class="sc">/</span>m</span>
<span id="cb41-42"><a href="#cb41-42" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(result,<span class="dv">4</span>))</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER                0.0892         0.9309
## FDR                 0.0046         0.0947
## TPR                 0.3977         0.5615</code></pre>
<p>B-H will give a larger value of TPR when its FDR is larger,it is
suitable for more relaxed multiple comparison scenarios.</p>
</div>
<div id="section" class="section level2">
<h2>7.4</h2>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package. The 12 observations are the times in hours between failures of
air conditioning equipment: 3,5,7,18,43,85,91,98,100,130,230,487 Assume
that the times between failures follow an exponential model Exp(λ).
Obtain the MLE of the hazard rate λ and use bootstrap to estimate the
bias and standard error of the estimate.</p>
<p>As the MLE of the hazard rate λ is <span class="math inline">\(\frac{n}{\sum_{i=1}^{n}x_{i}}\)</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>hours<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">12</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>mle<span class="ot">=</span><span class="cf">function</span>(value,indices){</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">length</span>(value[indices])<span class="sc">/</span><span class="fu">sum</span>(value[indices]))</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>}</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>lambda_hat<span class="ot">&lt;-</span><span class="fu">mle</span>(hours)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>lambda_b<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data =</span> hours,<span class="at">statistic =</span> mle,<span class="at">R =</span> B)</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">bias=</span><span class="fu">mean</span>(lambda_b<span class="sc">$</span>t)<span class="sc">-</span>lambda_hat,<span class="at">standard_error=</span><span class="fu">sd</span>(lambda_b<span class="sc">$</span>t)),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##           bias standard_error 
##         0.0013         0.0043</code></pre>
</div>
<div id="section-1" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>mle2<span class="ot">=</span><span class="cf">function</span>(value,indices){</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(value[indices])<span class="sc">/</span><span class="fu">length</span>(value[indices]))</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>}</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>lambda_b_back<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data =</span> hours,<span class="at">statistic =</span> mle2,<span class="at">R =</span> B)</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>bootstrap_ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(lambda_b_back,<span class="at">conf =</span><span class="fl">0.95</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="fu">print</span>(bootstrap_ci)</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = lambda_b_back, conf = 0.95, type = c(&quot;norm&quot;, 
##     &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 32.5, 183.4 )   ( 20.7, 169.1 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.1, 195.4 )   ( 57.1, 226.3 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>The differences between each method stem from different assumptions
about the null hypothesis and sample distribution, resulting in slightly
different confidence intervals.</p>
<p>#homework5</p>
</div>
</div>
<div id="section-2" class="section level1">
<h1>7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>eigenvalue<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>value<span class="ot">&lt;-</span>eigenvalue<span class="sc">$</span>values[<span class="fu">order</span>(<span class="sc">-</span>(eigenvalue<span class="sc">$</span>values))]</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>theta<span class="ot">&lt;-</span>value[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(value)</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">88</span></span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a>  jack.scor<span class="ot">&lt;-</span>scor[<span class="sc">-</span>i,]</span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>  sigma.hat<span class="ot">&lt;-</span><span class="fu">cov</span>(jack.scor)</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a>  ss<span class="ot">&lt;-</span><span class="fu">eigen</span>(sigma.hat)</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>  vv<span class="ot">&lt;-</span>ss<span class="sc">$</span>values[<span class="fu">order</span>(<span class="sc">-</span>(ss<span class="sc">$</span>values))]</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>  theta.hat[i]<span class="ot">&lt;-</span>vv[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(vv)</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>}</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>jack.bias<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.hat)<span class="sc">-</span>theta)</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>jack.se<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.hat<span class="sc">-</span>theta)<span class="sc">**</span><span class="dv">2</span>))</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="at">jackknife.estimates.of.bias=</span>jack.bias,<span class="at">jackknife.estimates.of.standerd.error=</span>jack.se),<span class="dv">4</span>))</span></code></pre></div>
<pre><code>##           jackknife.estimates.of.bias jackknife.estimates.of.standerd.error 
##                                0.0011                                0.0496</code></pre>
</div>
<div id="section-3" class="section level1">
<h1>7.10</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(magnetic)   </span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>e1<span class="ot">&lt;-</span>e2<span class="ot">&lt;-</span>e3<span class="ot">&lt;-</span>e4<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>yhat1<span class="ot">&lt;-</span>yhat2<span class="ot">&lt;-</span>yhat3<span class="ot">&lt;-</span>yhat4<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>SSR1<span class="ot">&lt;-</span>SSR2<span class="ot">&lt;-</span>SSR3<span class="ot">&lt;-</span>SSR4<span class="ot">&lt;-</span>SST1<span class="ot">&lt;-</span>SST2<span class="ot">&lt;-</span>SST3<span class="ot">&lt;-</span>SST4<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>ybar<span class="ot">&lt;-</span><span class="fu">mean</span>(magnetic)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  y<span class="ot">&lt;-</span>magnetic[<span class="sc">-</span>k]</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  x<span class="ot">&lt;-</span>chemical[<span class="sc">-</span>k]</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  J1<span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  yhat1[k]<span class="ot">&lt;-</span>J1<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J1<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  e1[k]<span class="ot">&lt;-</span>magnetic[k]<span class="sc">-</span>yhat1[k]</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  SSR1[k]<span class="ot">&lt;-</span>(yhat1[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  SST1[k]<span class="ot">&lt;-</span>(magnetic[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  J2<span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)) </span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>  yhat2[k]<span class="ot">&lt;-</span>J2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>    J2<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>  e2[k]<span class="ot">&lt;-</span>magnetic[k]<span class="sc">-</span>yhat2[k]</span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a>  SSR2[k]<span class="ot">&lt;-</span>(yhat2[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>  SST2[k]<span class="ot">&lt;-</span>(magnetic[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a>  J3<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x) </span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a>  logyhat3<span class="ot">&lt;-</span>J3<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J3<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]</span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a>  yhat3[k]<span class="ot">&lt;-</span><span class="fu">exp</span>(logyhat3)</span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a>  e3[k]<span class="ot">&lt;-</span>magnetic[k]<span class="sc">-</span>yhat3[k]</span>
<span id="cb49-29"><a href="#cb49-29" tabindex="-1"></a>  SSR3[k]<span class="ot">&lt;-</span>(yhat3[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-30"><a href="#cb49-30" tabindex="-1"></a>  SST3[k]<span class="ot">&lt;-</span>(magnetic[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-31"><a href="#cb49-31" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" tabindex="-1"></a>  J4<span class="ot">&lt;-</span><span class="fu">lm</span>(y <span class="sc">~</span> x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>)) </span>
<span id="cb49-33"><a href="#cb49-33" tabindex="-1"></a>  yhat4[k]<span class="ot">&lt;-</span>J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k] <span class="sc">+</span></span>
<span id="cb49-34"><a href="#cb49-34" tabindex="-1"></a>  J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb49-35"><a href="#cb49-35" tabindex="-1"></a>  e4[k]<span class="ot">&lt;-</span>magnetic[k]<span class="sc">-</span>yhat4[k]</span>
<span id="cb49-36"><a href="#cb49-36" tabindex="-1"></a>  SSR4[k]<span class="ot">&lt;-</span>(yhat4[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-37"><a href="#cb49-37" tabindex="-1"></a>  SST4[k]<span class="ot">&lt;-</span>(magnetic[k]<span class="sc">-</span>ybar)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb49-38"><a href="#cb49-38" tabindex="-1"></a>}</span>
<span id="cb49-39"><a href="#cb49-39" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="dv">51</span><span class="sc">/</span><span class="dv">50</span><span class="sc">*</span><span class="fu">sum</span>(SSR1)<span class="sc">/</span><span class="fu">sum</span>(SST1),<span class="dv">51</span><span class="sc">/</span><span class="dv">49</span><span class="sc">*</span><span class="fu">sum</span>(SSR2)<span class="sc">/</span><span class="fu">sum</span>(SST2),<span class="dv">51</span><span class="sc">/</span><span class="dv">50</span><span class="sc">*</span><span class="fu">sum</span>(SSR3)<span class="sc">/</span><span class="fu">sum</span>(SST3),<span class="dv">51</span><span class="sc">/</span><span class="dv">48</span><span class="sc">*</span><span class="fu">sum</span>(SSR4)<span class="sc">/</span><span class="fu">sum</span>(SST4))) </span></code></pre></div>
<pre><code>## [1] 0.5450654 0.5944676 0.4676507 0.5818290</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic
model, would be the best fit for the data. What’s more, the quadratic
model has the largest <span class="math inline">\(R^{2}\)</span>, so it
is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>.</p>
</div>
<div id="section-4" class="section level1">
<h1>8.1</h1>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">library</span>(RVAideMemoire)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>x1<span class="ot">=</span><span class="fu">sort</span>(weight[feed <span class="sc">==</span><span class="st">&quot;soybean&quot;</span>])</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>ys<span class="ot">=</span><span class="fu">sort</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>])</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>xs<span class="ot">=</span><span class="fu">sample</span>(x1, <span class="at">size =</span> <span class="fu">length</span>(ys))</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>rep<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>zs<span class="ot">=</span><span class="fu">c</span>(xs, ys)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">length</span>(xs)</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>n<span class="ot">=</span>n1<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>Ts<span class="ot">=</span><span class="fu">numeric</span>(rep)</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>rep) {</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>  ks<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, n1, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>  zs1<span class="ot">=</span>zs[ks]</span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>  zs2<span class="ot">=</span>zs[<span class="sc">-</span>ks]</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>  Ts[i]<span class="ot">=</span><span class="fu">cramer.test</span>(zs1, zs2)<span class="sc">$</span>statistic</span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a>}</span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>(<span class="at">cvm=</span><span class="fu">cramer.test</span>(x, y))</span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>T.hat<span class="ot">=</span>cvm<span class="sc">$</span>statistic</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>(<span class="at">p.hat=</span><span class="fu">mean</span>(<span class="fu">abs</span>(T.hat) <span class="sc">&lt;</span> <span class="fu">abs</span>(Ts)))</span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a><span class="fu">hist</span>(Ts)</span></code></pre></div>
<p>1 -dimensional nonparametric Cramer-Test with kernel phiCramer (on
equality of two distributions)</p>
<pre><code>x-sample:  52  values        y-sample:  52  values</code></pre>
<p>critical value for confidence level 95 % : 8.625 observed statistic
3.75 , so that hypothesis (“x is distributed as y”) is ACCEPTED .
estimated p-value = 0.2617383</p>
<pre><code>[result based on  1000   ordinary  bootstrap-replicates]</code></pre>
<p>0.99</p>
</div>
<div id="section-5" class="section level1">
<h1>8.2</h1>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>soybean<span class="ot">=</span>chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed<span class="sc">==</span><span class="st">&quot;soybean&quot;</span>]</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>linseed <span class="ot">=</span>chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed<span class="sc">==</span><span class="st">&quot;linseed&quot;</span>]</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(soybean)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">length</span>(linseed)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>tmp<span class="ot">=</span><span class="fu">min</span>(n, m)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>soybean<span class="ot">=</span><span class="fu">sort</span>(soybean[<span class="dv">1</span><span class="sc">:</span>tmp])</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>linseed<span class="ot">=</span><span class="fu">sort</span>(linseed[<span class="dv">1</span><span class="sc">:</span>tmp])</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>zs<span class="ot">=</span><span class="fu">c</span>(soybean, linseed)</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>spearman.cor.test<span class="ot">=</span><span class="fu">cor.test</span>(<span class="at">x =</span> soybean, <span class="at">y =</span> linseed, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">length</span>(zs)</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>rep<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>rhos<span class="ot">=</span><span class="fu">numeric</span>(rep)</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  i<span class="ot">=</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>k, k<span class="sc">/</span><span class="dv">2</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>  xs<span class="ot">=</span>zs[i]</span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  ys<span class="ot">=</span>zs[<span class="sc">-</span>i]</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  rhos[b]<span class="ot">=</span><span class="fu">cor</span>(<span class="at">x =</span> xs, <span class="at">y =</span> ys, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>}</span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a></span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a><span class="fu">hist</span>(rhos, <span class="at">breaks =</span> <span class="dv">100</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>(<span class="at">theta.hat=</span>spearman.cor.test<span class="sc">$</span>estimate)</span></code></pre></div>
<pre><code>## rho 
##   1</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a>spearman.cor.test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>(<span class="at">p.hat=</span><span class="fu">mean</span>(<span class="fu">abs</span>(rhos) <span class="sc">&gt;</span> <span class="fu">abs</span>(theta.hat)))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>(<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.05</code></pre>
<p>We can find that p.hat&lt;alpha,so H0 rejected.</p>
<p>#homework6</p>
<div id="section-6" class="section level2">
<h2>9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution. Discard the first 1000 of the chain, and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution (see qcauchyor qt with df=1). Recall
that a Cauchy(θ,η) distribution has density function</p>
<p><span class="math display">\[
f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^{2})}
\]</span></p>
<p>The standard Cauchy has the Cauchy(θ =1,η= 0) density. (Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom.)</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>theta<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>eta<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>  <span class="fu">stopifnot</span>(theta <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span>(theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">**</span><span class="dv">2</span>)))</span>
<span id="cb65-9"><a href="#cb65-9" tabindex="-1"></a>}</span>
<span id="cb65-10"><a href="#cb65-10" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb65-12"><a href="#cb65-12" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb65-13"><a href="#cb65-13" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb65-14"><a href="#cb65-14" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb65-15"><a href="#cb65-15" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" tabindex="-1"></a>x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean =</span> <span class="dv">1</span>)</span>
<span id="cb65-17"><a href="#cb65-17" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb65-18"><a href="#cb65-18" tabindex="-1"></a>  xt<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>]</span>
<span id="cb65-19"><a href="#cb65-19" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean =</span> xt)</span>
<span id="cb65-20"><a href="#cb65-20" tabindex="-1"></a>  r<span class="ot">=</span><span class="fu">f</span>(y)<span class="sc">*</span><span class="fu">dnorm</span>(<span class="at">x=</span>xt,<span class="at">mean=</span>y)<span class="sc">/</span>(<span class="fu">f</span>(xt)<span class="sc">*</span><span class="fu">dnorm</span>(<span class="at">x=</span>y,<span class="at">mean =</span> xt))</span>
<span id="cb65-21"><a href="#cb65-21" tabindex="-1"></a>  <span class="cf">if</span>(u[i]<span class="sc">&lt;=</span>r){</span>
<span id="cb65-22"><a href="#cb65-22" tabindex="-1"></a>    x[i]<span class="ot">=</span>y</span>
<span id="cb65-23"><a href="#cb65-23" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb65-24"><a href="#cb65-24" tabindex="-1"></a>    k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb65-25"><a href="#cb65-25" tabindex="-1"></a>    x[i]<span class="ot">=</span>xt</span>
<span id="cb65-26"><a href="#cb65-26" tabindex="-1"></a>  }</span>
<span id="cb65-27"><a href="#cb65-27" tabindex="-1"></a>}</span>
<span id="cb65-28"><a href="#cb65-28" tabindex="-1"></a>is <span class="ot">=</span> <span class="dv">5001</span><span class="sc">:</span><span class="dv">5500</span></span>
<span id="cb65-29"><a href="#cb65-29" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb65-30"><a href="#cb65-30" tabindex="-1"></a><span class="fu">plot</span>(is, x[is], <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb65-31"><a href="#cb65-31" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">ppoints</span>(<span class="dv">100</span>)</span>
<span id="cb65-32"><a href="#cb65-32" tabindex="-1"></a>QR<span class="ot">&lt;-</span><span class="fu">tan</span>(pi<span class="sc">*</span>(a<span class="fl">-0.5</span>))</span>
<span id="cb65-33"><a href="#cb65-33" tabindex="-1"></a>Q<span class="ot">&lt;-</span><span class="fu">quantile</span>(x, a)</span>
<span id="cb65-34"><a href="#cb65-34" tabindex="-1"></a><span class="fu">qqplot</span>(QR, Q, <span class="at">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb65-35"><a href="#cb65-35" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Cauty Quantiles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb65-36"><a href="#cb65-36" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="at">col=</span><span class="st">&#39;blue&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>plot.x <span class="ot">=</span> <span class="fu">seq</span>(<span class="fu">min</span>(x), <span class="fu">max</span>(x), <span class="fl">0.01</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">lines</span>(plot.x, <span class="fu">f</span>(plot.x))</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-7" class="section level2">
<h2>9.8</h2>
<p>This example appears in [40]. Consider the bivariate density</p>
<p><span class="math display">\[
f(x,y) \propto \binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\ x=0,1,...,n,0\le
y\le 1
\]</span></p>
<p>It can be shown (see e.g. [23]) that for fixed a,b,n, the conditional
distributions are Binomial(n,y)andBeta(x+a,n−x+b). Use the Gibbs sampler
to generate a chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">30</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>f<span class="ot">=</span><span class="cf">function</span>(x,y){</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">factorial</span>(n)<span class="sc">/</span>(<span class="fu">factorial</span>(x)<span class="sc">*</span><span class="fu">factorial</span>(n<span class="sc">-</span>x))<span class="sc">*</span>(y<span class="sc">**</span>(x<span class="sc">+</span>a<span class="dv">-1</span>))<span class="sc">*</span>((<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">**</span>(n<span class="sc">-</span>x<span class="sc">+</span>b<span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>}</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">5000</span></span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> m,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m){</span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  xt<span class="ot">=</span>X[i<span class="dv">-1</span>,]</span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>  xt[<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rbinom</span>(<span class="dv">1</span>,n,xt[<span class="dv">2</span>])</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>  xt[<span class="dv">2</span>]<span class="ot">=</span><span class="fu">rbeta</span>(<span class="dv">1</span>,xt[<span class="dv">1</span>]<span class="sc">+</span>a,n<span class="sc">-</span>xt[<span class="dv">1</span>]<span class="sc">+</span>b)</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>  X[i,]<span class="ot">=</span>xt</span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>}</span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>x<span class="ot">&lt;-</span>X[<span class="dv">1001</span><span class="sc">:</span>m,]</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Means: &#39;</span>,<span class="fu">round</span>(<span class="fu">colMeans</span>(x),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Means:  40.66 0.41</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Standard errors: &#39;</span>,<span class="fu">round</span>(<span class="fu">apply</span>(x,<span class="dv">2</span>,sd),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Standard errors:  8.42 0.07</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;Correlation coefficients: &#39;</span>, <span class="fu">round</span>(<span class="fu">cor</span>(x[,<span class="dv">1</span>],x[,<span class="dv">2</span>]),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## Correlation coefficients:  0.82</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],<span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">2</span>],<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(X[<span class="dv">1</span>]),<span class="fu">expression</span>(X[<span class="dv">2</span>])),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>#homework7</p>
</div>
<div id="section-8" class="section level2">
<h2>11.3</h2>
<p>(a)Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[
\sum_{k=0}^{\infty}\frac{(-1)^{k}}{k!2^{k}}\frac{||a||^{2k+2}}{(2k+1)(2k+2)}\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}
\]</span> where d ≥ 1 is an integer, a is a vector in <span class="math inline">\(R^{d}\)</span>,and ||.|| denotes the Euclidean
norm. Perform the arithmetic so that the coefficients can be computed
for (almost) arbitrarily large k and d. (This sum converges for all
<span class="math inline">\(a\in R^{d}\)</span>. (b) Modify the function
so that it computes and returns the sum. (c) Evaluate the sum when <span class="math inline">\(a=(1,2)^{T}\)</span>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>k_term <span class="ot">=</span> <span class="cf">function</span>(a,k){</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>  <span class="fu">return</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">*</span> <span class="fu">exp</span>((<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(<span class="fu">norm</span>(a,<span class="at">type=</span><span class="st">&quot;2&quot;</span>))<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>}</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">500</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>thesum <span class="ot">=</span> <span class="cf">function</span>(a){</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb74-10"><a href="#cb74-10" tabindex="-1"></a>    z[i]<span class="ot">&lt;-</span><span class="fu">k_term</span>(a,i<span class="dv">-1</span>)</span>
<span id="cb74-11"><a href="#cb74-11" tabindex="-1"></a>  }</span>
<span id="cb74-12"><a href="#cb74-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(z))</span>
<span id="cb74-13"><a href="#cb74-13" tabindex="-1"></a>}</span>
<span id="cb74-14"><a href="#cb74-14" tabindex="-1"></a><span class="fu">thesum</span>(a)</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}(1+\frac{u^{2}}{k-1})^{-k/2}du
\\=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi
k}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}(1+\frac{u^{2}}{k})^{-(k+1)/2}du\\
for\ a,where\\
c_{k}=\sqrt{\frac{a^{2}k}{k+1-a^{2}}}
\]</span> Compare the solutions with the points A(k) in Exercise
11.4.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">24</span>)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">23</span>)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> m) {</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>       <span class="fu">return</span>(<span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(x<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">log</span>(pi<span class="sc">*</span>(x<span class="dv">-1</span>))) <span class="sc">-</span> <span class="fu">lgamma</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>}</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>       <span class="fu">return</span>((<span class="fu">f</span>(k)<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="sc">+</span> (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>),<span class="at">lower =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value) <span class="sc">-</span> (<span class="fu">f</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="sc">+</span> (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">lower =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">upper =</span> <span class="cn">Inf</span>)<span class="sc">$</span>value))</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>}</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>A[k] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g, <span class="at">lower =</span> <span class="fl">0.01</span>, <span class="at">upper =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">sqrt</span>(k)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>}</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> n) {</span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>       <span class="fu">return</span>(<span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">2</span>) <span class="sc">+</span> <span class="fu">lgamma</span>(x<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="fu">log</span>(pi<span class="sc">*</span>(x<span class="dv">-1</span>))) <span class="sc">-</span> <span class="fu">lgamma</span>((x<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)))</span>
<span id="cb76-20"><a href="#cb76-20" tabindex="-1"></a>}</span>
<span id="cb76-21"><a href="#cb76-21" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb76-22"><a href="#cb76-22" tabindex="-1"></a>       <span class="fu">return</span>((<span class="fu">f</span>(k)<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="sc">+</span> (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>k<span class="sc">/</span><span class="dv">2</span>), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>value) <span class="sc">-</span> (<span class="fu">f</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">integrate</span>(<span class="cf">function</span>(x)(<span class="dv">1</span> <span class="sc">+</span> (x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>k)<span class="sc">^</span>(<span class="sc">-</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> <span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>k<span class="sc">/</span>(k<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">$</span>value))</span>
<span id="cb76-23"><a href="#cb76-23" tabindex="-1"></a>}</span>
<span id="cb76-24"><a href="#cb76-24" tabindex="-1"></a>B[k] <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(h, <span class="at">lower =</span> <span class="fl">0.01</span>, <span class="at">upper =</span> <span class="dv">1</span><span class="sc">+</span><span class="fu">sqrt</span>(k)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">$</span>root</span>
<span id="cb76-25"><a href="#cb76-25" tabindex="-1"></a>}</span>
<span id="cb76-26"><a href="#cb76-26" tabindex="-1"></a></span>
<span id="cb76-27"><a href="#cb76-27" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, A[m])</span>
<span id="cb76-28"><a href="#cb76-28" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(B[n], <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="cb76-29"><a href="#cb76-29" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb76-30"><a href="#cb76-30" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(k, A, B)</span>
<span id="cb76-31"><a href="#cb76-31" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">A</th>
<th align="right">B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">NA</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.533576</td>
<td align="right">1.533576</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">1.562721</td>
<td align="right">1.562721</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">1.584427</td>
<td align="right">1.584427</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">1.601166</td>
<td align="right">1.601166</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">1.614524</td>
<td align="right">1.614524</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.625385</td>
<td align="right">1.625385</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">1.634415</td>
<td align="right">1.634415</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">1.642027</td>
<td align="right">1.642027</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">1.648536</td>
<td align="right">1.648536</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">1.654175</td>
<td align="right">1.654175</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">1.659097</td>
<td align="right">1.659097</td>
</tr>
<tr class="odd">
<td align="right">16</td>
<td align="right">1.663408</td>
<td align="right">1.663408</td>
</tr>
<tr class="even">
<td align="right">17</td>
<td align="right">1.667301</td>
<td align="right">1.667301</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="right">1.670724</td>
<td align="right">1.670724</td>
</tr>
<tr class="even">
<td align="right">19</td>
<td align="right">1.673819</td>
<td align="right">1.673819</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="right">1.676589</td>
<td align="right">1.676589</td>
</tr>
<tr class="even">
<td align="right">21</td>
<td align="right">1.679154</td>
<td align="right">1.679154</td>
</tr>
<tr class="odd">
<td align="right">22</td>
<td align="right">1.681470</td>
<td align="right">1.681470</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">1.683610</td>
<td align="right">1.683610</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">1.685548</td>
<td align="right">1.685548</td>
</tr>
<tr class="even">
<td align="right">25</td>
<td align="right">1.687347</td>
<td align="right">1.687347</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.720610</td>
<td align="right">1.720610</td>
</tr>
<tr class="even">
<td align="right">500</td>
<td align="right">1.729738</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">1000</td>
<td align="right">1.730924</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>We can find that when K is the same,A(k)=B(k)</p>
<p>Suppose T1,…,Tn are i.i.d. samples drawn from the exponential
distribution with expectation λ. Those values greater than τ are not
observed due to right censorship, so that the observed values are Yi =
TiI(Ti ≤ τ) + τI(Ti &gt; τ), i = 1,…,n. Suppose τ = 1 and the observed
Yi values are as follows: 0.54,
0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85 Use the E-M algorithm to
estimate λ, compare your result with the observed data MLE (note: Yi
follows a mixture distribution)</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>) </span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>censored <span class="ot">&lt;-</span> Y <span class="sc">==</span> tau </span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)  </span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="fl">1e-6</span>  </span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span>  </span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a><span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  Y_complete <span class="ot">&lt;-</span> Y</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>  Y_complete[censored] <span class="ot">&lt;-</span> tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>Y_complete)</span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>  </span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_new) <span class="sc">&lt;</span> tolerance) {</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;steps:&quot;</span>, iter, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>  }</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a></span>
<span id="cb77-20"><a href="#cb77-20" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb77-21"><a href="#cb77-21" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## steps: 6</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lambda：&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## lambda： 1.826704</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>lambda_mle_observed <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>Y)</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;MLE：&quot;</span>, lambda_mle_observed, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## MLE： 1.932835</code></pre>
<p>#homework8</p>
</div>
<div id="section-10" class="section level2">
<h2>11.7</h2>
<p>Use the simplex algorithm to solve the following problem. Minimize 4x
+2y +9z subject to <span class="math display">\[
\begin{aligned}
2x+y+z&amp;\le 2\\
x-y+3z&amp;\le3\\
x\ge0,y\ge0,z&amp;\ge0
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>constraints <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>                        <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>direction <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb83-12"><a href="#cb83-12" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective, constraints, direction, rhs, <span class="at">compute.sens =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-14"><a href="#cb83-14" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal value:&quot;</span>, solution<span class="sc">$</span>objval, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal value: 0</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Optimal solution (x, y, z):&quot;</span>, solution<span class="sc">$</span>solution, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Optimal solution (x, y, z): 0 0 0</code></pre>
</div>
</div>
<div id="section-11" class="section level1">
<h1>11.1</h1>
<div id="section-12" class="section level2">
<h2>3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt,
mpg ~ I(1 / disp) + wt )</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a> mpg <span class="sc">~</span> disp,</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a> mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a> mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a> mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a> )</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>v1<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">4</span>)</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>v1[i] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(i,<span class="cf">function</span>(i) {<span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)})</span>
<span id="cb87-11"><a href="#cb87-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-13" class="section level2">
<h2>4</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;-
sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a> rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a> mtcars[rows, ]</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>})</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>v2<span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">10</span>)</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>v2[i] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps[i], lm, <span class="at">formula =</span> mpg <span class="sc">~</span> disp)</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-14" class="section level2">
<h2>5</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^{2}\)</span> using the function below. rsq &lt;-
function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="co"># question 3</span></span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="fu">sapply</span>(v1, rsq)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co">#question 4</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="fu">sapply</span>(v2, rsq)</span></code></pre></div>
<pre><code>##  [1] 0.6742887 0.7654731 0.7365994 0.6381468 0.6895924 0.7203000 0.7175647
##  [8] 0.7103959 0.7172205 0.7444450</code></pre>
</div>
</div>
<div id="section-15" class="section level1">
<h1>11.2</h1>
<div id="section-16" class="section level2">
<h2>3</h2>
<p>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)),
simplify = FALSE ) Extra challenge: get rid of the anonymous function by
using [[ directly.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>         <span class="dv">100</span>,</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>         <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>         <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>       )</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</span></code></pre></div>
<pre><code>##   [1] 0.85524641 0.12737417 0.94239444 0.43004859 0.69875601 0.35013579
##   [7] 0.44473687 0.44000653 0.94799770 0.37759592 0.17166047 0.78863544
##  [13] 0.21065203 0.41746191 0.75574772 0.50844003 0.06524222 0.46196995
##  [19] 0.57756183 0.33784394 1.00000000 0.70965074 0.81551125 0.83292322
##  [25] 0.75259579 0.23486847 0.58160441 0.28034335 0.86815750 0.99299094
##  [31] 0.70818765 0.04318474 0.74879509 0.49119742 0.96901613 0.20550702
##  [37] 0.68147133 0.90670409 0.44355204 0.43886923 0.36651719 0.29720746
##  [43] 0.66964615 0.91753404 0.38403486 0.35820046 0.45780197 0.63342598
##  [49] 0.65379719 0.77527347 0.05274756 0.16273482 0.56785263 0.50957206
##  [55] 0.92166046 0.32424641 0.59315633 1.00000000 0.68386511 0.51260967
##  [61] 0.66820607 0.15554228 0.74977879 0.58127586 0.87701923 0.95565866
##  [67] 0.93262923 0.57640536 0.51506659 0.40724893 0.47614646 0.81380672
##  [73] 0.97585686 0.35608182 0.80606980 0.84651405 0.95818678 0.79715200
##  [79] 0.63123432 0.03912644 0.04823819 0.91265023 0.77302637 1.00000000
##  [85] 0.20997463 0.05715558 0.61822448 0.85237870 0.46762042 0.67672466
##  [91] 0.13355409 0.82593589 0.12267606 0.04031284 0.28955839 0.96053397
##  [97] 0.49578716 0.62512974 0.09051037 0.42903830</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span></code></pre></div>
<pre><code>##   [1] 0.85524641 0.12737417 0.94239444 0.43004859 0.69875601 0.35013579
##   [7] 0.44473687 0.44000653 0.94799770 0.37759592 0.17166047 0.78863544
##  [13] 0.21065203 0.41746191 0.75574772 0.50844003 0.06524222 0.46196995
##  [19] 0.57756183 0.33784394 1.00000000 0.70965074 0.81551125 0.83292322
##  [25] 0.75259579 0.23486847 0.58160441 0.28034335 0.86815750 0.99299094
##  [31] 0.70818765 0.04318474 0.74879509 0.49119742 0.96901613 0.20550702
##  [37] 0.68147133 0.90670409 0.44355204 0.43886923 0.36651719 0.29720746
##  [43] 0.66964615 0.91753404 0.38403486 0.35820046 0.45780197 0.63342598
##  [49] 0.65379719 0.77527347 0.05274756 0.16273482 0.56785263 0.50957206
##  [55] 0.92166046 0.32424641 0.59315633 1.00000000 0.68386511 0.51260967
##  [61] 0.66820607 0.15554228 0.74977879 0.58127586 0.87701923 0.95565866
##  [67] 0.93262923 0.57640536 0.51506659 0.40724893 0.47614646 0.81380672
##  [73] 0.97585686 0.35608182 0.80606980 0.84651405 0.95818678 0.79715200
##  [79] 0.63123432 0.03912644 0.04823819 0.91265023 0.77302637 1.00000000
##  [85] 0.20997463 0.05715558 0.61822448 0.85237870 0.46762042 0.67672466
##  [91] 0.13355409 0.82593589 0.12267606 0.04031284 0.28955839 0.96053397
##  [97] 0.49578716 0.62512974 0.09051037 0.42903830</code></pre>
</div>
<div id="section-17" class="section level2">
<h2>6</h2>
<p>Implement a combination of Map() and vapply() to create a lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What arguments should the function
take?</p>
</div>
</div>
<div id="section-18" class="section level1">
<h1>17.5</h1>
<div id="section-19" class="section level2">
<h2>4</h2>
<p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>chisq_test_fast <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Both inputs must be numeric vectors&quot;</span>)</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  }</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Input vectors must not contain missing values&quot;</span>)</span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>  }</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x, y)</span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(n)</span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">colSums</span>(n)</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sum</span>(n)</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">tcrossprod</span>(n1,n2) <span class="sc">/</span> k</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a></span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a>  x_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((n <span class="sc">-</span> m)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> m)</span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a>  df <span class="ot">&lt;-</span> (<span class="fu">length</span>(n1) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">length</span>(n2) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(x_stat, <span class="at">df =</span> df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a></span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x_stat =</span> x_stat, <span class="at">df =</span> df, <span class="at">p.value =</span> p.value)</span>
<span id="cb97-19"><a href="#cb97-19" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-20" class="section level2">
<h2>5</h2>
<p>Can you make a faster version of table() for the case of an input of
two integer vectors with no missing values? Can you use it to speed up
your chi-square test?</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">library</span>(fastmatch)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x)) x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(x)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(y)) y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(y)</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  </span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  a_sort <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(a))</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  b_ssort <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(b))</span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  </span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  a_len <span class="ot">&lt;-</span> <span class="fu">length</span>(a_sort)</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>  b_len <span class="ot">&lt;-</span> <span class="fu">length</span>(b_sort)</span>
<span id="cb98-11"><a href="#cb98-11" tabindex="-1"></a>  </span>
<span id="cb98-12"><a href="#cb98-12" tabindex="-1"></a>  dim <span class="ot">&lt;-</span> <span class="fu">c</span>(a_len, b_len)</span>
<span id="cb98-13"><a href="#cb98-13" tabindex="-1"></a>  pr <span class="ot">&lt;-</span> a_len <span class="sc">*</span> b_len</span>
<span id="cb98-14"><a href="#cb98-14" tabindex="-1"></a>  dn <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> a_sort, <span class="at">b =</span> b_sort)</span>
<span id="cb98-15"><a href="#cb98-15" tabindex="-1"></a>  </span>
<span id="cb98-16"><a href="#cb98-16" tabindex="-1"></a>  bin <span class="ot">&lt;-</span> <span class="fu">fmatch</span>(a, a_sort) <span class="sc">+</span> a_len <span class="sc">*</span> <span class="fu">fmatch</span>(b, b_sort) <span class="sc">-</span> a_len</span>
<span id="cb98-17"><a href="#cb98-17" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">tabulate</span>(bin, pr)</span>
<span id="cb98-18"><a href="#cb98-18" tabindex="-1"></a>  </span>
<span id="cb98-19"><a href="#cb98-19" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">array</span>(y, <span class="at">dim =</span> dim, <span class="at">dimnames =</span> dn)</span>
<span id="cb98-20"><a href="#cb98-20" tabindex="-1"></a>  <span class="fu">class</span>(y) <span class="ot">&lt;-</span> <span class="st">&quot;table&quot;</span></span>
<span id="cb98-21"><a href="#cb98-21" tabindex="-1"></a>  </span>
<span id="cb98-22"><a href="#cb98-22" tabindex="-1"></a>  y</span>
<span id="cb98-23"><a href="#cb98-23" tabindex="-1"></a>}</span></code></pre></div>
<p>#homework9</p>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x,y)\propto \left ( \begin{matrix}
n \\
x
\end{matrix}
\right )y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,...,n,0\le y\le 1.
\]</span> It can be shown (see e.g. [23]) that for fixed a,b,n, the
conditional distributions are Binomial(n,y) and Beta(x+a,n−x+b). Use the
Gibbs sampler to generate a chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a><span class="fu">library</span>(SA24204180)</span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="co"># 运行R和Rcpp版本</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>x_r <span class="ot">=</span> <span class="fu">gibbsR</span>(n, a)</span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>x_cpp <span class="ot">=</span> <span class="fu">gibbsC</span>(n, a)</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a><span class="fu">qqplot</span>(x_r[,<span class="dv">1</span>], x_cpp[,<span class="dv">1</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot for X&quot;</span>, </span>
<span id="cb99-13"><a href="#cb99-13" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;R Gibbs Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Rcpp Gibbs Samples&quot;</span>)</span>
<span id="cb99-14"><a href="#cb99-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">qqplot</span>(x_r[,<span class="dv">2</span>], x_cpp[,<span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;QQ Plot for Y&quot;</span>, </span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;R Gibbs Samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Rcpp Gibbs Samples&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a>benchmark_results <span class="ot">=</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb101-4"><a href="#cb101-4" tabindex="-1"></a>  <span class="at">R_version =</span> <span class="fu">gibbsR</span>(n, a),</span>
<span id="cb101-5"><a href="#cb101-5" tabindex="-1"></a>  <span class="at">Rcpp_version =</span> <span class="fu">gibbsC</span>(n, a),</span>
<span id="cb101-6"><a href="#cb101-6" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb101-7"><a href="#cb101-7" tabindex="-1"></a>)</span>
<span id="cb101-8"><a href="#cb101-8" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span></code></pre></div>
<pre><code>## Unit: microseconds
##          expr    min     lq    mean  median     uq    max neval cld
##     R_version 1958.2 1979.2 2042.29 2007.80 2126.2 2201.0    10  a 
##  Rcpp_version  301.9  308.7  321.64  318.95  334.2  351.2    10   b</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
